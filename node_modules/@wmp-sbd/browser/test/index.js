'use strict';

const browser = require('../');

// 2018-07-12 기준으로 서비스중인 모든 상점 url 정리해서 넣어둠.
const urls = [
  {shopName: '45678', url: 'http://45678.or.kr/product/detail.html?product_no=4269'},
  {shopName: '마리앙플러스', url: 'http://www.mariangplus.co.kr/shop/shopdetail.html?branduid=1056267'},
  {shopName: '마이바니', url: 'http://www.mybany.com/product/detail.html?product_no=23467'},
  {shopName: '메롱샵', url: 'http://www.merongshop.com/product/detail.html?product_no=32584'},
  {shopName: '마이더스비', url: 'http://www.midasb.co.kr/shop/shopdetail.html?branduid=621524'},
  {shopName: '마리앙', url: 'http://www.mariang.co.kr/shop/shopdetail.html?branduid=47263'},
  {shopName: '머쉬멜로우', url: 'http://www.marsh-mallow.co.kr/product/detail.html?product_no=23096'},
  {shopName: '마리공주의신발장', url: 'http://www.princessmarie.co.kr/shop/shopdetail.html?branduid=1029618'},
  {shopName: '모어데이', url: 'http://moreday.kr/shop/shopdetail.html?branduid=3403954'},
  {shopName: '미나그램', url: 'http://www.mina-gram.com/product/detail.html?product_no=5837'},
  {shopName: '초코맘', url: 'http://www.chocomom.com/shop/shopdetail.html?branduid=41577'},
  {shopName: '에프터먼데이', url: 'http://www.aftermonday.com/shop/shopdetail.html?branduid=2567431'},
  {shopName: '엔피오나', url: 'http://www.annpiona.co.kr/shop/shopdetail.html?branduid=713067'},
  {shopName: '엑스타렌', url: 'http://www.xtaren.kr/goods/goods_view.php?goodsNo=1000000492'},
  {shopName: '어커버', url: 'http://www.acover.co.kr/product/detail.html?product_no=1499'},
  {shopName: '엔비룩', url: 'http://www.envylook.com/product/detail.html?product_no=23427'},
  {shopName: '오픈더도어', url: 'http://www.openthedoor.kr/product/detail.html?product_no=1166'},
  {shopName: '에이와비', url: 'http://awab.co.kr/product/detail.html?product_no=5134'},
  {shopName: '위즈위드', url: 'http://www.wizwid.com/CSW/handler/wizwid/kr/ShopProduct-Start?CategoryID=001091555&AssortID=752300928&ClickCategoryID=001091555'},
  {shopName: '인더마랑', url: 'http://inthemarant.com/product/%EB%B0%80%EB%9D%BC-vest/642/category/54/display/1/'},
  {shopName: '윙스몰', url: 'http://www.wingsmall.co.kr/product/detail.html?product_no=49341'},
  {shopName: '에이인', url: 'http://www.a-in.kr/product/detail.html?product_no=14778'},
  {shopName: '안녕윤수야', url: 'http://www.helloyoonsoo.com/product/detail.html?product_no=20722'},
  {shopName: '유니크바니', url: 'http://www.uniquebunny.co.kr/product/detail.html?product_no=3707'},
  {shopName: '이란지', url: 'http://www.eranzi.co.kr/shop/shopdetail.html?branduid=988397'},
  {shopName: '오어유', url: 'http://www.or-u.co.kr/shop/shopdetail.html?branduid=3404018'},
  {shopName: '어바웃썸', url: 'http://aboutsome.co.kr/product/detail.html?product_no=1510'},
  {shopName: '업타운홀릭', url: 'http://www.uptownholic.com/shop/shopdetail.html?branduid=104252'},
  {shopName: '아덴', url: 'http://www.i-arden.com/shop/shopdetail.html?branduid=146464'},
  {shopName: '아스피린', url: 'http://ahspirin.com/product/detail.html?product_no=3038'},
  {shopName: '아르체', url: 'http://www.archei.co.kr/product/detail.html?product_no=32558'},
  {shopName: '에이썸빈', url: 'http://www.yubsshop.com/product/detail.html?product_no=38065'},
  {shopName: '엘사베로니', url: 'http://www.ellsaveroni.com/shop/shopdetail.html?branduid=2014332'},
  {shopName: '오앤에이', url: 'http://www.o-n-a.co.kr/product/7%EC%9B%9419%EC%9D%BC-%EC%98%88%EC%95%BD%EB%B0%9C%EC%86%A1-116%EC%A2%85-%EC%8B%A0%EC%83%81-%ED%8B%B0%EC%85%94%EC%B8%A0-%ED%99%94%EC%9D%B4%ED%8A%B8-ver1/526/category/25/display/1/'},
  {shopName: '데일리먼데이', url: 'http://www.dailymonday.com/shop/shopdetail.html?branduid=78168'},
  {shopName: '드랑', url: 'http://www.derang.me/product/detail.html?product_no=12497'},
  {shopName: '드레스투미', url: 'http://www.dress2me.com/shop/shopdetail.html?branduid=1170985'},
  {shopName: '다니러브', url: 'http://www.danilove.co.kr/shop/shopdetail.html?branduid=97942'},
  {shopName: '도드리', url: 'http://www.dodry.net/product/detail.html?product_no=30537'},
  {shopName: '디스코살롱', url: 'http://www.discosalon.co.kr/product/detail.html?product_no=14614'},
  {shopName: '디앤써', url: 'http://www.d-answer.com/shop/shopdetail.html?branduid=1397623'},
  {shopName: '데비웨어', url: 'http://www.devi-wear.com/product/detail.html?product_no=1959'},
  {shopName: '데이엘', url: 'http://www.dayel.kr/shop/shopdetail.html?branduid=1345259'},
  {shopName: '라라엘', url: 'http://www.lalael.com/shop/shopdetail.html?branduid=2550411'},
  {shopName: '로니엘', url: 'http://www.roniel.co.kr/product/detail.html?product_no=7981'},
  {shopName: '레드옴므', url: 'http://www.redhomme.com/product/detail.html?product_no=35724'},
  {shopName: '럭시퀸', url: 'http://www.luxyqueen.net/product/detail.html?product_no=24330'},
  {shopName: '룸페커', url: 'http://www.roompacker.co.kr/shop/shopdetail.html?branduid=79424'},
  {shopName: '룩넌', url: 'http://looknone.co.kr/product/detail.html?product_no=3213'},
  {shopName: '루비아나', url: 'http://www.rubiana.net/product/detail.html?product_no=4630'},
  {shopName: '룩걸', url: 'http://www.lookgirl.co.kr/product/%ED%95%98%EB%A6%AC-%EC%8A%A4%ED%8A%B8%EB%9E%A9%EC%9B%90%ED%94%BC%EC%8A%A4-ops-new-5/19088/category/96/display/1/'},
  {shopName: '리나제이', url: 'http://www.linaj.co.kr/shop/shopdetail.html?branduid=2189078'},
  {shopName: '루서인', url: 'http://rooseoin.com/product/detail.html?product_no=38803'},
  {shopName: '휠라 공식 온라인 스토어', url: 'http://www.fila.co.kr/product/view.asp?ProductNo=30087'},
  {shopName: '할리샵', url: 'https://www.hollyshop.co.kr/shop/shopdetail.html?branduid=771089'},
  {shopName: '핫핑', url: 'http://www.hotping.co.kr/product/detail.html?product_no=23417'},
  {shopName: '홀리가든', url: 'http://www.hollygarden.co.kr/shop/shopdetail.html?branduid=1397598'},
  {shopName: '헬로우스위티', url: 'http://www.hellosweety.co.kr/shop/shopdetail.html?branduid=665038'},
  {shopName: '블랙스완', url: 'http://www.blackswanbyiris.com/shop/goods/goods_view.php?goodsno=4887'},
  {shopName: '베이직어바웃', url: 'http://www.basicabout.com/product/detail.html?product_no=3342'},
  {shopName: '바이흰티', url: 'http://www.hyn-t.com/product/da-%EC%97%90%EC%9D%B4%EC%A7%95-%EB%B0%98%ED%8C%94%ED%8B%B0/4355/category/119/display/1/'},
  {shopName: '베리바미', url: 'http://verybalmy.com/product/detail.html?product_no=152'},
  {shopName: '불량소녀', url: 'http://www.bullang.com/product/detail.html?product_no=28354'},
  {shopName: '박남매', url: 'http://www.pak-namae.com/product/detail.html?product_no=17522'},
  {shopName: '벨크만', url: 'http://www.belkman.com/product/detail.html?product_no=10770'},
  {shopName: '가시여우', url: 'http://www.gasifox.co.kr/shop/shopdetail.html?branduid=1095908'},
  {shopName: '구룸', url: 'http://www.9-room.com/shop/shopdetail.html?branduid=1089498'},
  {shopName: '게리오', url: 'http://www.gerio.co.kr/shop/shopdetail.html?branduid=54839'},
  {shopName: '갠소', url: 'http://www.gaenso.com/shop/shopdetail.html?branduid=513003'},
  {shopName: '금찌', url: 'http://www.gumzzi.co.kr/shop/shopdetail.html?branduid=143196'},
  {shopName: '나비올라', url: 'http://www.nabyup.com/product/%ED%94%84%EB%A0%8C%EC%B9%98-%EB%B6%88%EB%8F%85-%ED%88%AC%ED%94%BC%EC%8A%A4/4750/category/28/display/1/'},
  {shopName: '나인', url: 'http://www.nain.co.kr/shop/detail.php?pno=CDEFE822CD044DEE4BAF9459821A664C'},
  {shopName: '노르웨이숲', url: 'http://www.norwayforest.co.kr/shop/shopdetail.html?branduid=435071'},
  {shopName: '난닝구', url: 'http://www.naning9.com/shop/view.php?index_no=50223'},
  {shopName: '썸파티&윙스걸', url: 'http://www.ssumparty.co.kr/product/detail.html?product_no=31077'},
  {shopName: '슈즈라벨', url: 'http://www.shuz-label.com/product/detail.html?product_no=8194'},
  {shopName: '사뿐', url: 'http://www.sappun.co.kr/shop/shopdetail.html?branduid=1130227'},
  {shopName: '스타일맨', url: 'http://www.styleman.kr/product/detail.html?product_no=33332'},
  {shopName: '스타일난다', url: 'http://www.stylenanda.com/product/detail.html?product_no=222603'},
  {shopName: '스나이퍼샵', url: 'http://www.snipershop.co.kr/product/detail.html?product_no=23897'},
  {shopName: '슈퍼스타아이', url: 'http://www.superstari.co.kr/shop/shopdetail.html?branduid=138662'},
  {shopName: '시크릿라벨', url: 'http://secretlabel.co.kr/shop/shopdetail.html?branduid=518765'},
  {shopName: '썸데이이프', url: 'http://www.somedayif.com/product/detail.html?product_no=11066'},
  {shopName: '수이디', url: 'http://www.su-oo.com/product/detail.html?product_no=2021'},
  {shopName: '시크폭스', url: 'http://www.chicfox.co.kr/shop/shopdetail.html?branduid=492401'},
  {shopName: '쓰리컷', url: 'http://www.threecut.kr/product/detail.html?product_no=520'},
  {shopName: '샐러드룸', url: 'http://salad-room.com/product/detail.html?product_no=1708'},
  {shopName: '시크헤라', url: 'http://www.chichera.co.kr/shop/shopdetail.html?branduid=377619'},
  {shopName: '쏘뉴', url: 'http://sonho.kr/product/%EB%B9%84%EC%95%99%EC%B9%B4%EC%8B%9C%EC%8A%A4%EB%A3%A8%EC%84%B8%ED%8A%B83color/4012/category/60/display/1/'},
  {shopName: '핑크시슬리', url: 'http://www.pinksisly.com/shop/shopdetail.html?branduid=123698'},
  {shopName: '핑크에이지', url: 'http://www.pinkage.co.kr/shop/shopdetail.html?branduid=8703'},
  {shopName: '팝콘베리', url: 'http://www.popcornberry.com/product/detail.html?product_no=7328'},
  {shopName: '플라이데이', url: 'http://www.flyday.co.kr/shop/shopdetail.html?branduid=1114708'},
  {shopName: '프롬핏', url: 'http://fromfit.com/product/detail.html?product_no=2463'},
  {shopName: '플랜제이', url: 'http://www.planj.co.kr/product/detail.html?product_no=19299'},
  {shopName: '포니지엔느', url: 'http://www.ponyzn.com/shop/shopdetail.html?branduid=1102740'},
  {shopName: '플랫퍼', url: 'http://www.flatper.co.kr/product/detail.html?product_no=2143'},
  {shopName: '패션풀', url: 'http://www.fashion-full.com/product/detail.html?product_no=18099'},
  {shopName: '퍼니걸스', url: 'http://funnygirls.co.kr/product/detail.html?product_no=1742'},
  {shopName: '피치피크닉', url: 'http://www.peachpicnic.com/product/detail.html?product_no=9292'},
  {shopName: '프로인드', url: 'http://freund.co.kr/product/detail.html?product_no=2259'},
  {shopName: '조군샵', url: 'http://www.jogunshop.com/shop/shopdetail.html?branduid=23314'},
  {shopName: '저스트원', url: 'http://www.justone.co.kr/shop/shopdetail.html?branduid=71673'},
  {shopName: '젬마월드', url: 'http://www.zemmaworld.com/product/detail.html?product_no=21835'},
  {shopName: '주와', url: 'http://www.zuwa.co.kr/shop/shopdetail.html?branduid=753572'},
  {shopName: '토모나리', url: 'http://www.tomonari.co.kr/shop/shopdetail.html?branduid=72097'},
  {shopName: '캔디글로우', url: 'http://www.candyglow.co.kr/shop/shopdetail.html?branduid=116441'},
  {shopName: '커먼유니크', url: 'http://www.common-unique.com/product/detail.html?product_no=7715'},
  {shopName: '큐니걸스', url: 'http://www.qng.co.kr/product/detail.html?product_no=53453'}
];

describe('Crawler', function() {
  describe('Browser', function() {

    it('should be success open without error', (done) => {
      browser.open('https://www.google.co.kr/').then(() => {
        done();
      }, (err) => {
        should.not.exist(err);
        done();
      });
    });

    it('should be success getRemoteFileSize without error', (done) => {
      browser.getRemoteFileSize('http://app-storage-003.cafe24.com/bannermanage2/kinamily/2016/08/09/e661692c929f6a1df097a3e3b911df08.png', (err, res) => {
        should.not.exist(err);
        done();
      });
    });

    urls.forEach((each, idx, array) => {
      it(`should be success extractImagesUris without error`, (done) => {
        browser.extractImagesUris(each.url, {
          'ext': ['jpg', 'jpeg'],
          'minSize': 50000 // byte
        }, (err, res) => {
          should.not.exist(err);
          console.log(`${each.shopName} 추출된 이미지 갯수 ==> ${res.length}`);
          done();
        });
      });
    });


    it('should be success remote file download without error', (done) => {
      browser.download('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRVQeEntBIwhsesbKIzAVX0MIb4AaSV34namIXmHzi4olSRSZ1Q', __dirname + '/scratch/test.jpg', (err, res) => {
        should.not.exist(err);
        done();
      });
    });

    it('should be success remote file download and convert without error', (done) => {
      browser.downloadAndConvert('http://imgnews.naver.net/image/009/2017/05/18/0003943288_001_20170518164503668.jpg?type=w540').then((res) => {
        done();
      }, (err) => {
        done(err);
      });
    });

    it('should be success remote file downloadToTmp without error', (done) => {
      browser.downloadToTmp('http://stylenanda.com/design1/kr/main_img04.jpg', (err, res) => {
        should.not.exist(err);
        done();
      });
    });
  });
});